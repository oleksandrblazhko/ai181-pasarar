| Ідентифікатор та назва атаки (вразливості)            | Вимога (FR, NFR)                                                                                                                                                                                                           | Приклад вразливостей, які може використовувати атака                                                                                                                                                                                                                                                                                     | Приклад запобігання успішної реалізації атаки                                                                                                                                                                                                                                                                                                  |
| ----------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A01:2021 – Broken Access Control                      | FR5. Додавання своєї подорожі Користувачем <br> FR6. Функція додавання користувачем подорожей у «Обране» <br> FR8. Функція видалення своєї подорожі користувачем <br> FR9. Функція редагування своєї подорожі користувачем | Програма використовує неперевірені дані у виклику SQL, який отримує доступ до інформації облікового запису. Зловмисник просто змінює параметр «acct» браузера, щоб надіслати будь-який номер облікового запису, який він хоче. У разі неправильної перевірки зловмисник може отримати доступ до будь-якого облікового запису користувача | Контроль доступу ефективний лише в довіреному серверному коді або безсерверному API, де зловмисник не може змінити перевірку контролю доступу або метадані. Контроль доступу моделі повинен забезпечувати право власності на запис, а не приймати, що користувач може створювати, читати, оновлювати або видаляти будь-який запис.             |
| A02:2021 - Cryptographic Failures                     | FR1. Функція реєстрації гостя в системі <br> FR2. Функція авторизації користувача в системі                                                                                                                                | База даних паролів використовує несолоні або прості хеші для зберігання всіх паролів. Недолік завантаження файлу дозволяє зловмиснику отримати базу даних паролів. Хеші, згенеровані простими або швидкими хеш-функціями, можуть бути зламані графічними процесорами.                                                                    | Класифікуйте дані, які обробляються, зберігаються або передаються програмою. Визначте, які дані є конфіденційними відповідно до законів про конфіденційність, нормативних вимог або потреб бізнесу. Переконайтеся, що ви зашифрували всі конфіденційні дані в стані спокою. Вимкніть кешування для відповідей, які містять конфіденційні дані. |
| A03:2021 – Injection                                  | FR7. Функція перегляду користувачем подорожі                                                                                                                                                                               | Додаток використовує ненадійні дані при створенні наступного вразливого виклику SQL                                                                                                                                                                                                                                                      | Попередній варіант є безпечним використанням API, який повністю включає використання інтерпретатора, надає параметризований інтерфейс або переходить на засоби об’єктно-реляційного розміщення                                                                                                                                                 |
| A04:2021 – Insecure Design                            | FR2. Функція авторизації користувача в системі <br>                                                                                                                                                                        | Робочий процес відновлення облікових даних може включати «питання та відповіді», що заборонено NIST 800-63b, OWASP ASVS та OWASP Top 10. Питання та відповіді не можна читати як докази особистості, оскільки більше однієї людини можуть знати відповіді, тому вони заборонені.                                                         | Створіть і використовуйте бібліотеку безпечних шаблонів проектування або готовий до використання компонент. Використовуйте моделювання загроз для критичної автентифікації, контролю доступу, бізнес-логіки та потоків ключів                                                                                                                  |
| A05:2021 – Security Misconfiguration                  | FR6. Функція додавання користувачем подорожей у «Обране» <br> FR8. Функція видалення своєї подорожі користувачем <br> FR9. Функція редагування своєї подорожі користувачем                                                 | Конфігурація додатків сервера дозволяє повертати користувачам докладні повідомлення про помилки, наприклад, трасування стека. Це потенційно розкриває конфіденційну інформацію або основні недоліки, такі як версії компонентів, які, як відомо, небезпечні.                                                                             | Повинні бути реалізовані безпечні процеси установки                                                                                                                                                                                                                                                                                            |
| A07:2021 – Identification and Authentication Failures | FR1. Функція реєстрації гостя в системі <br> FR2. Функція авторизації користувача в системі                                                                                                                                | Вкидання облікових даних, використання списків відомих паролів – поширена атака. Більшість атак на автентифікацію відбуваються через використання паролів, що продовжується, як єдиний фактор.                                                                                                                                           | По можливості впровадьте багатофакторну автентифікацію, щоб запобігти автоматичній підстановці облікових даних, перебору та атакам повторного використання вкрадених облікових даних.                                                                                                                                                          |
| A10:2021 – Server-Side Request Forgery                | NFR2. Максимальний час відповіді від сервера не більше 4 секунд <br> NFR3. Середній час відповіді від сервера 2 секунди <br> NFR4. Запити на сервер відправляються асинхронно <br>                                         | Компрометація внутрішніх служб – зловмисник може зловживати внутрішніми службами для подальших атак, таких як віддалене виконання коду (RCE) або відмова в обслуговуванні (DoS).                                                                                                                                                         | Очистіть і перевірте всі вхідні дані, надані клієнтом. Застосуйте схему URL-адреси, порт і призначення за допомогою позитивного дозволеного списку. Не надсилайте необроблені відповіді клієнтам. Вимкнути перенаправлення HTTP                                                                                                                |
