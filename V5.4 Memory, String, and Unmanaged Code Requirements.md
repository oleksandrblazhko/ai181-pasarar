# **V5.4 Пам'ять, рядок і некерований код**

Наступні вимоги застосовуватимуться лише тоді, коли програма використовує системну мову або некерований код.

| #     | Опис                                                                                                                                                                                     | L1  | L2  | L3  | CWE |
| ----- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --- | --- | --- | --- |
| 5.4.1 | Переконайтеся, що програма використовує безпечний для пам’яті рядок, безпечнішу копію пам’яті та арифметику вказівника для виявлення або запобігання переповненню стека, буфера чи купи. |     | ✓   | ✓   | 120 |
| 5.4.2 | Переконайтеся, що рядки формату не приймають потенційно ворожих вхідних даних і є постійними.                                                                                            |     | ✓   | ✓   | 134 |
| 5.4.3 | Перевірте, чи використовуються методи перевірки знаків, діапазонів і введення, щоб запобігти переповненню цілих чисел.                                                                   |     | ✓   | ✓   | 190 |

# **CWE**

## **CWE-120: Копіювання буфера без перевірки розміру вхідних даних («Класичне переповнення буфера»)**

### **Опис**

Програма копіює вхідний буфер у вихідний буфер, не перевіряючи, чи розмір вхідного буфера менший за розмір вихідного буфера, що призводить до переповнення буфера.

### **Розширений опис**

Умова переповнення буфера виникає, коли програма намагається помістити в буфер більше даних, ніж він може вмістити, або коли програма намагається помістити дані в область пам’яті за межами буфера. Найпростішим типом помилки та найпоширенішою причиною переповнення буфера є «класичний» випадок, коли програма копіює буфер без обмеження обсягу копіювання. Існують і інші варіанти, але існування класичного переповнення переконливо говорить про те, що програміст не розглядає навіть найпростіший захист безпеки.

### **Застосовні платформи**

**Мови**<br>

- C (невизначена поширеність)
- C++ (невизначена поширеність)
- Клас: Асамблея (невизначена поширеність)

### **Загальні наслідки**

| Область застосування                             | Вплив                                                                                                                                                                                                                                                                                                  | Ймовірність |
| ------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------- |
| Цілісність<br> Конфіденційність <br> Доступність | Технічний вплив: зміна пам'яті; Виконайте несанкціонований код або команди переповнення буфера часто можна використовувати для виконання довільного коду, який зазвичай виходить за межі неявної політики безпеки програми. Це часто можна використовувати для підриву будь-якої іншої служби безпеки. |             |
| Доступність                                      | Технічний вплив: зміна пам'яті; DoS: збій, вихід або перезапуск; DoS: споживання ресурсів (ЦП) Переповнення буфера зазвичай призводить до збоїв. Можливі й інші атаки, що призводять до відсутності доступності, зокрема введення програми в нескінченний цикл.                                        |             |

### **Ймовірність експлойту**

Високий

## **CWE-134: використання зовнішнього контрольованого формату**

### **Опис**

Програмне забезпечення використовує функцію, яка приймає рядок формату як аргумент, але рядок формату походить із зовнішнього джерела.

### **Розширений опис**

Коли зловмисник може змінити рядок зовнішнього формату, це може призвести до переповнення буфера, відмови в обслуговуванні або проблем із представленням даних. Слід зазначити, що за деяких обставин, таких як інтернаціоналізація, набір рядків формату керується ззовні за проектом. Якщо джерело цих рядків формату є надійним (наприклад, міститься лише у файлах бібліотеки, які може змінювати лише системний адміністратор), зовнішній елемент керування може сам по собі не становити вразливості.

### **Застосовні платформи**

**Мови**<br>

- C (часто поширений)
- C++ (часто поширений)
- Perl (рідко поширений)

### **Загальні наслідки**

| Область застосування                              | Вплив                                                                                                                                                  | Ймовірність |
| ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------- |
| Конфіденційність                                  | Технічний вплив: проблеми із форматуванням формату читання пам’яті дозволяють розкривати інформацію, що може значно спростити використання програми.   |             |
| Цілісність <br> Конфіденційність <br> Доступність | Технічний вплив: зміна пам'яті; Виконайте несанкціонований код або команди. Проблеми форматування рядка можуть призвести до виконання довільного коду. |             |

### **Ймовірність експлойту**

Високий

## **CWE-190: цілочисельне переповнення або обертання**

### **Опис**

Програмне забезпечення виконує обчислення, яке може спричинити цілочисельне переповнення або обертання, коли логіка припускає, що результуюче значення завжди буде більшим за початкове значення. Це може створити інші недоліки, коли обчислення використовується для керування ресурсами або контролю виконання.

### **Розширений опис**

Цілочисельне переповнення або обертання відбувається, коли ціле значення збільшується до значення, яке є занадто великим для збереження у пов’язаному представленні. Коли це станеться, значення може перетворитися на дуже маленьке або від’ємне число. Хоча це може бути запланованою поведінкою в обставинах, які покладаються на упаковку, це може мати наслідки для безпеки, якщо упаковка є неочікуваною. Це особливо актуально, якщо цілочисельне переповнення може бути викликано за допомогою введених користувачем даних. Це стає критично важливим для безпеки, коли результат використовується для керування циклом, прийняття рішення про безпеку або визначення зсуву чи розміру в таких поведінках, як розподіл пам’яті, копіювання, конкатенація тощо.

### **Застосовні платформи**

**Мови**<br>
Клас: Не залежить від мови (поширеність не визначена)

### **Загальні наслідки**

| Область застосування                                    | Вплив                                                                                                                                                                                                                                                                                                                          | Ймовірність |
| ------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------- |
| Доступність                                             | Технічний вплив: DoS: збій, вихід або перезапуск; DoS: споживання ресурсів (ЦП); DoS: споживання ресурсів (пам'яті); DoS: нестабільність Ця слабкість зазвичай призводить до невизначеної поведінки та, отже, до збоїв. У випадку переповнення, що включає змінні індексу циклу, ймовірність нескінченних циклів також висока. |             |
| Цілісність                                              | Технічний вплив: змінення пам’яті. Якщо відповідне значення є важливим для даних (на відміну від потоку), сталося просте пошкодження даних. Крім того, якщо обертання призводить до інших умов, таких як переповнення буфера, може статися подальше пошкодження пам’яті.                                                       |             |
| Конфіденційність <br> Доступність <br> Контроль доступу | Технічний вплив: виконання несанкціонованого коду або команд; Механізм захисту від обходу Ця слабкість іноді може викликати переповнення буфера, яке можна використовувати для виконання довільного коду. Зазвичай це виходить за межі неявної політики безпеки програми.                                                      |             |

### **Ймовірність експлойту**

Середня
